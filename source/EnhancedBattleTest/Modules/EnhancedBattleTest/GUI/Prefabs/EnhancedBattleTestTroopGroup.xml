<Prefab>
  <Window>
    <ListPanel WidthSizePolicy="Fixed" SuggestedWidth="585" HeightSizePolicy="CoverChildren" MarginLeft="50" MarginTop="20" LayoutImp.LayoutMethod="VerticalBottomToTop">
      <Children>

        <PartyHeaderToggleWidget DoNotPassEventsToChildren="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Top" MarginLeft="10" MarginRight="10" CollapseIndicator="Description\CollapseParent\GroupTitle\CollapseIndicator" WidgetToClose="..\TroopsList" ListPanel="..\TroopsList" RenderLate="true" UpdateChildrenStates="true">
          <Children>

            <ListPanel Id="Description" DoNotAcceptEvents="true" WidthSizePolicy="StretchToParent" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Center" LayoutImp.LayoutMethod="HorizontalLeftToRight" UpdateChildrenStates="true">
              <Children>

                <Widget Id="CollapseParent" WidthSizePolicy="Fixed" HeightSizePolicy="CoverChildren" SuggestedWidth="120" HorizontalAlignment="Center" UpdateChildrenStates="true">
                  <Children>
                    <TextWidget Id="GroupTitle" DataSource="{TroopGroupName}" Text="@Text" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Right" Brush="SPOptions.GameKeysGroup.Title.Text" ClipContents="false">
                      <Children>
                        <BrushWidget Id="CollapseIndicator" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedHeight="19" SuggestedWidth="19" VerticalAlignment="Center" PositionXOffset="-26" PositionYOffset="-3" Brush="SPOptions.GameKeysgroup.ExpandIndicator" OverrideDefaultStateSwitchingEnabled="true" />
                      </Children>
                    </TextWidget>
                  </Children>
                </Widget>

                <BrushWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" SuggestedHeight="2" VerticalAlignment="Center" MarginLeft="15" Brush="SPOptions.CollapserLine" />
              </Children>
            </ListPanel>

          </Children>
        </PartyHeaderToggleWidget>

        <ListPanel Id="TroopsList" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" MarginTop="35" LayoutImp.LayoutMethod="VerticalBottomToTop">
          <Children>


            <ListPanel WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" LayoutImp.LayoutMethod="HorizontalLeftToRight">
              <Children>
                <ButtonWidget DoNotPassEventsToChildren="true" Command.Click="PushTroop" IsEnabled="@PushEnabled" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="80" SuggestedHeight="40" MarginLeft="30" Brush="ButtonBrush2" PositiveBehaviourBrush="ButtonBrush1">
                  <Children>
                    <TextWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Brush="SPOptions.Dropdown.Center.Text" Text="+" />
                  </Children>
                </ButtonWidget>
                <ButtonWidget DoNotPassEventsToChildren="true" Command.Click="PopTroop" IsEnabled="@PopEnabled" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="80" SuggestedHeight="40" MarginLeft="30" Brush="ButtonBrush2" PositiveBehaviourBrush="ButtonBrush1">
                  <Children>
                    <TextWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Brush="SPOptions.Dropdown.Center.Text" Text="-" />
                  </Children>
                </ButtonWidget>
              </Children>
            </ListPanel>

            <ListPanel DataSource="{Troops}" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" LayoutImp.LayoutMethod="VerticalBottomToTop">
              <ItemTemplate>
                <ListPanel WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" LayoutImp.LayoutMethod="VerticalBottomToTop">
                  <Children>
                    <EnhancedBattleTestCharacterButton DataSource="{CharacterButton}" HorizontalAlignment="Left" VerticalAlignment="Center" MarginTop="15" />

                    <ListPanel WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" LayoutImp.LayoutMethod="HorizontalLeftToRight" HorizontalAlignment="Center" VerticalAlignment="Center" MarginLeft="100" MarginTop="5">
                      <Children>
                        <RichTextWidget DataSource="{NumberText}" Text="@Text" WidthSizePolicy="Fixed" SuggestedWidth="100" HeightSizePolicy="CoverChildren" HorizontalAlignment="Left" VerticalAlignment="Center" Brush="CustomBattle.Value.Text" />
                        <EditableTextWidget DataSource="{Number}" Text="@Text" WidthSizePolicy="Fixed" SuggestedWidth="200" HeightSizePolicy="Fixed" SuggestedHeight="30" HorizontalAlignment="Center" VerticalAlignment="Center" />
                        <Widget WidthSizePolicy="Fixed" SuggestedWidth="100" HeightSizePolicy="Fixed" SuggestedHeight="30" HorizontalAlignment="Center" VerticalAlignment="Center">
                          <Children>
                            <Widget DataSource="{Number}" IsVisible="@IsIllegal" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Center">
                              <Children>
                                <RichTextWidget DataSource="{..\InvalidText}" Text="@Text" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" VerticalAlignment="Center" Brush="CustomBattle.Value.Text" />
                              </Children>
                            </Widget>
                          </Children>
                        </Widget>
                      </Children>
                    </ListPanel>

                  </Children>
                </ListPanel>
              </ItemTemplate>
            </ListPanel>

          </Children>
        </ListPanel>

      </Children>
    </ListPanel>
  </Window>
</Prefab>